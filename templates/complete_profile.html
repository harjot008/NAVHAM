<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Your Profile - NavDisha Interns</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            color: white;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8rem;
            font-weight: 600;
        }

        .container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .form-card {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }

        .form-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .form-header h2 {
            color: #333;
            margin-bottom: 0.5rem;
            font-size: 2rem;
        }

        .form-header p {
            color: #666;
            font-size: 1.1rem;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 10px;
            margin: 1.5rem 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
        }

        .step-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-group label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #555;
            font-size: 1rem;
        }

        .required {
            color: #e74c3c;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .checkbox-item:hover {
            border-color: #667eea;
            background: white;
        }

        .checkbox-item.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .checkbox-item input {
            display: none;
        }

        .checkbox-item i {
            margin-right: 0.5rem;
            font-size: 1.2rem;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-family: inherit;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            background: #e9ecef;
            border-color: #dee2e6;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .message {
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            text-align: center;
            font-weight: 500;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .container {
                margin: 1rem auto;
                padding: 0 0.5rem;
            }

            .form-card {
                padding: 1.5rem;
            }
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e0e0e0;
            margin: 0 0.5rem;
            transition: all 0.3s ease;
        }

        .step-dot.active {
            background: #667eea;
        }

        .step-dot.completed {
            background: #28a745;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1><i class="fas fa-graduation-cap"></i> NavDisha-Interns</h1>
        <p>Complete your profile to get personalized internship recommendations</p>
    </header>

    <div class="container">
        <div class="form-card">
            <div class="form-header">
                <h2><i class="fas fa-user-plus"></i> Complete Your Profile</h2>
                <p>Help us understand you better to recommend the perfect internships</p>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>

            <div class="step-indicator">
                <div class="step-dot active" data-step="0"></div>
                <div class="step-dot" data-step="1"></div>
                <div class="step-dot" data-step="2"></div>
            </div>

            <div id="messageContainer"></div>

            <form id="profileForm">
                <!-- Step 1: Basic Information -->
                <div class="form-step active" data-step="0">
                    <h3 class="step-title"><i class="fas fa-user"></i> Basic Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="name">Full Name <span class="required">*</span></label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="age">Age <span class="required">*</span></label>
                            <input type="number" id="age" name="age" min="16" max="30" required>
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender <span class="required">*</span></label>
                            <select id="gender" name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone" name="phone" placeholder="+91 XXXXX XXXXX">
                        </div>
                    </div>
                </div>

                <!-- Step 2: Location & Education -->
                <div class="form-step" data-step="1">
                    <h3 class="step-title"><i class="fas fa-map-marker-alt"></i> Location & Education</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="city">City <span class="required">*</span></label>
                            <input type="text" id="city" name="city" required>
                        </div>
                        <div class="form-group">
                            <label for="state">State <span class="required">*</span></label>
                            <select id="state" name="state" required>
                                <option value="">Select State</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                <option value="Assam">Assam</option>
                                <option value="Bihar">Bihar</option>
                                <option value="Chhattisgarh">Chhattisgarh</option>
                                <option value="Goa">Goa</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                <option value="Jharkhand">Jharkhand</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Maharashtra">Maharashtra</option>
                                <option value="Manipur">Manipur</option>
                                <option value="Meghalaya">Meghalaya</option>
                                <option value="Mizoram">Mizoram</option>
                                <option value="Nagaland">Nagaland</option>
                                <option value="Odisha">Odisha</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="Sikkim">Sikkim</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Telangana">Telangana</option>
                                <option value="Tripura">Tripura</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                <option value="Uttarakhand">Uttarakhand</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Delhi">Delhi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="education">Education Level <span class="required">*</span></label>
                            <select id="education" name="education" required>
                                <option value="">Select Education Level</option>
                                <option value="10th">10th Grade</option>
                                <option value="12th">12th Grade</option>
                                <option value="Diploma">Diploma</option>
                                <option value="Bachelor's">Bachelor's Degree</option>
                                <option value="Master's">Master's Degree</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="college">College/Institution</label>
                            <input type="text" id="college" name="college">
                        </div>
                    </div>
                </div>

                <!-- Step 3: Skills & Interests -->
                <div class="form-step" data-step="2">
                    <h3 class="step-title"><i class="fas fa-star"></i> Skills & Interests</h3>
                    <div class="form-group full-width">
                        <label for="skills">Skills (comma-separated)</label>
                        <textarea id="skills" name="skills" rows="3" placeholder="e.g., Python, Data Analysis, Communication, Leadership, Digital Marketing"></textarea>
                    </div>

                    <div class="form-group full-width">
                        <label>Preferred Internship Sectors <span class="required">*</span></label>
                        <div class="checkbox-group" id="sectorsGroup">
                            <div class="checkbox-item" data-value="Technology">
                                <input type="checkbox" name="interests" value="Technology">
                                <i class="fas fa-laptop-code"></i>
                                Technology
                            </div>
                            <div class="checkbox-item" data-value="Finance">
                                <input type="checkbox" name="interests" value="Finance">
                                <i class="fas fa-chart-line"></i>
                                Finance
                            </div>
                            <div class="checkbox-item" data-value="Marketing">
                                <input type="checkbox" name="interests" value="Marketing">
                                <i class="fas fa-bullhorn"></i>
                                Marketing
                            </div>
                            <div class="checkbox-item" data-value="Healthcare">
                                <input type="checkbox" name="interests" value="Healthcare">
                                <i class="fas fa-heartbeat"></i>
                                Healthcare
                            </div>
                            <div class="checkbox-item" data-value="Education">
                                <input type="checkbox" name="interests" value="Education">
                                <i class="fas fa-graduation-cap"></i>
                                Education
                            </div>
                            <div class="checkbox-item" data-value="Design">
                                <input type="checkbox" name="interests" value="Design">
                                <i class="fas fa-paint-brush"></i>
                                Design
                            </div>
                            <div class="checkbox-item" data-value="Sales">
                                <input type="checkbox" name="interests" value="Sales">
                                <i class="fas fa-handshake"></i>
                                Sales
                            </div>
                            <div class="checkbox-item" data-value="Content Writing">
                                <input type="checkbox" name="interests" value="Content Writing">
                                <i class="fas fa-pen"></i>
                                Content Writing
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="experience">Previous Experience (Optional)</label>
                        <textarea id="experience" name="experience" rows="3" placeholder="Brief description of any work experience, projects, or achievements"></textarea>
                    </div>
                </div>

                <div class="button-group">
                    <button type="button" class="btn btn-secondary" id="prevBtn" onclick="changeStep(-1)" style="display: none;">
                        <i class="fas fa-arrow-left"></i> Previous
                    </button>
                    <button type="button" class="btn btn-primary" id="nextBtn" onclick="changeStep(1)">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                    <button type="submit" class="btn btn-primary" id="submitBtn" style="display: none;">
                        <i class="fas fa-check"></i> Complete Profile
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentStep = 0;
        const totalSteps = 3;

        // Initialize form
        document.addEventListener('DOMContentLoaded', function() {
            updateStepDisplay();
            setupCheckboxes();
        });

        function setupCheckboxes() {
            const checkboxItems = document.querySelectorAll('.checkbox-item');
            checkboxItems.forEach(item => {
                item.addEventListener('click', function() {
                    const checkbox = this.querySelector('input[type="checkbox"]');
                    checkbox.checked = !checkbox.checked;
                    
                    if (checkbox.checked) {
                        this.classList.add('selected');
                    } else {
                        this.classList.remove('selected');
                    }
                });
            });
        }

        function changeStep(direction) {
            if (direction === 1 && !validateCurrentStep()) {
                return;
            }

            currentStep += direction;
            if (currentStep < 0) currentStep = 0;
            if (currentStep >= totalSteps) currentStep = totalSteps - 1;

            updateStepDisplay();
        }

        function updateStepDisplay() {
            // Update progress bar
            const progress = ((currentStep + 1) / totalSteps) * 100;
            document.getElementById('progressFill').style.width = progress + '%';

            // Update step indicators
            const stepDots = document.querySelectorAll('.step-dot');
            stepDots.forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index < currentStep) {
                    dot.classList.add('completed');
                } else if (index === currentStep) {
                    dot.classList.add('active');
                }
            });

            // Show/hide form steps
            const formSteps = document.querySelectorAll('.form-step');
            formSteps.forEach((step, index) => {
                step.classList.remove('active');
                if (index === currentStep) {
                    step.classList.add('active');
                }
            });

            // Update buttons
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');

            prevBtn.style.display = currentStep > 0 ? 'inline-flex' : 'none';
            
            if (currentStep === totalSteps - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-flex';
            } else {
                nextBtn.style.display = 'inline-flex';
                submitBtn.style.display = 'none';
            }
        }

        function validateCurrentStep() {
            const currentStepElement = document.querySelector(`.form-step[data-step="${currentStep}"]`);
            const requiredFields = currentStepElement.querySelectorAll('[required]');
            
            for (let field of requiredFields) {
                if (!field.value.trim()) {
                    field.focus();
                    showMessage('Please fill in all required fields', 'error');
                    return false;
                }
            }

            // Special validation for interests in step 2
            if (currentStep === 2) {
                const selectedInterests = document.querySelectorAll('input[name="interests"]:checked');
                if (selectedInterests.length === 0) {
                    showMessage('Please select at least one sector of interest', 'error');
                    return false;
                }
            }

            return true;
        }

        function showMessage(message, type) {
            const messageContainer = document.getElementById('messageContainer');
            messageContainer.innerHTML = `<div class="message ${type}">${message}</div>`;
            
            setTimeout(() => {
                messageContainer.innerHTML = '';
            }, 5000);
        }

        // Form submission
        document.getElementById('profileForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!validateCurrentStep()) {
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            
            try {
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Completing Profile...';
                
                const formData = new FormData(e.target);
                const data = Object.fromEntries(formData);
                
                // Collect selected interests
                const selectedInterests = Array.from(document.querySelectorAll('input[name="interests"]:checked'))
                    .map(cb => cb.value);
                data.interests = selectedInterests.join(', ');
                
                const response = await fetch('/submit-profile', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showMessage(result.message, 'success');
                    setTimeout(() => {
                        window.location.href = result.redirect;
                    }, 1500);
                } else {
                    showMessage(result.message, 'error');
                }
            } catch (error) {
                showMessage('Failed to complete profile. Please try again.', 'error');
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        });
    </script>
</body>
</html>